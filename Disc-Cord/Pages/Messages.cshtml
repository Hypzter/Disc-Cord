@page
@model Disc_Cord.Pages.MessagesModel
@inject SignInManager<Models.ApplicationUser> SignInManager
@inject UserManager<Models.ApplicationUser> UserManager
@{
	var user = await UserManager.GetUserAsync(User);

}
@if (Model.Messages != null)
{
	@foreach (var m in Model.Messages)
	{
		@foreach (var u in Model.Users)
		{
			@if(u.Id == m.SenderId)
			{
				<p>@u.UserName har skickat: </p>
				
			}

		}
		<p>@m.Text</p>
		<p>den @m.Timestamp.ToString()</p>

	}
}

<form method="post">

	<input asp-for="NewMessage.SenderId" type="hidden" value="@user.Id" />

	<label asp-for="NewMessage.ReceiverId"></label>
	<select asp-for="NewMessage.ReceiverId" asp-items="@(new SelectList(Model.Users, "Id", "UserName"))"></select>
	<textarea asp-for="NewMessage.Text" class="form-control" cols="40" rows="5"></textarea>
	<br>
	<input type="submit" name="addTask" value="Skicka" class="btn btn-primary" />

</form>